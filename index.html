<!doctype html>
<html lang="pt-BR" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz SaÃºde Feminina</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&amp;family=Nunito:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    .font-heading { font-family: 'Playfair Display', serif; }
    .font-body { font-family: 'Nunito', sans-serif; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes pulse-soft {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-10px); }
    }
    .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
    .animate-pulse-soft { animation: pulse-soft 2s ease-in-out infinite; }
    .animate-float { animation: float 3s ease-in-out infinite; }
    .delay-100 { animation-delay: 0.1s; }
    .delay-200 { animation-delay: 0.2s; }
    .delay-300 { animation-delay: 0.3s; }
    .delay-400 { animation-delay: 0.4s; }
    .option-btn {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .option-btn:hover:not(:disabled) {
      transform: translateX(8px);
      box-shadow: 0 4px 20px rgba(190,130,150,0.3);
    }
    .progress-bar {
      transition: width 0.5s ease-out;
    }
    .blob {
      border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
    }
  </style>
</head>
<body class="h-full font-body">
<div id="app" class="h-full w-full overflow-auto" style="background: linear-gradient(135deg, #FDF2F4 0%, #F8E8EC 50%, #F0E0E6 100%);">
 <!-- Decorative Elements -->
 <div class="fixed top-10 left-10 w-32 h-32 bg-pink-200 opacity-30 blob animate-float" style="animation-delay: 0s;"></div>
 <div class="fixed bottom-20 right-10 w-24 h-24 bg-rose-200 opacity-30 blob animate-float" style="animation-delay: 1s;"></div>
 <div class="fixed top-1/2 right-20 w-16 h-16 bg-pink-300 opacity-20 blob animate-float" style="animation-delay: 2s;"></div>
 <div class="relative z-10 min-h-full flex flex-col items-center justify-center p-4 sm:p-6 md:p-8">
   <!-- Start Screen -->
   <div id="start-screen" class="w-full max-w-2xl text-center">
     <div class="animate-fade-in">
       <div class="mb-6">
         <svg class="w-20 h-20 sm:w-24 sm:h-24 mx-auto animate-pulse-soft" viewbox="0 0 100 100" fill="none"><circle cx="50" cy="50" r="45" fill="#BE8296" fill-opacity="0.2" /> <path d="M50 25C50 25 35 35 35 50C35 58 38 65 50 75C62 65 65 58 65 50C65 35 50 25 50 25Z" fill="#BE8296" /> <circle cx="50" cy="48" r="8" fill="#FDF2F4" />
         </svg>
       </div>
       <h1 id="quiz-title" class="font-heading text-3xl sm:text-4xl md:text-5xl font-bold mb-4" style="color: #6B4A54;">SaÃºde Feminina</h1>
       <p class="text-base sm:text-lg md:text-xl mb-2" style="color: #8B6B75;">Quiz sobre Bem-Estar e Assoalho PÃ©lvico</p>
       <p class="text-sm sm:text-base mb-8 max-w-md mx-auto" style="color: #A88B95;">Teste seus conhecimentos e aprenda mais sobre cuidados essenciais para a saÃºde da mulher</p>
       <button id="start-btn" onclick="startQuiz()" class="option-btn px-8 py-4 rounded-full font-semibold text-lg text-white shadow-lg hover:shadow-xl" style="background: linear-gradient(135deg, #BE8296 0%, #A06B7D 100%);"> âœ¨ ComeÃ§ar Quiz </button>
       <p class="mt-6 text-sm" style="color: #B89AA5;">40 perguntas â€¢ 10 min</p>
     </div>
   </div>
   <!-- Quiz Screen -->
   <div id="quiz-screen" class="w-full max-w-2xl hidden">
     <div class="rounded-3xl p-6 sm:p-8 shadow-xl" style="background: rgba(255,255,255,0.85); backdrop-filter: blur(10px);">
       <!-- Progress -->
       <div class="mb-6">
         <div class="flex justify-between items-center mb-2"><span class="text-sm font-medium" style="color:#8B6B75;">Pergunta <span id="current-q">1</span> de 40</span> <span id="score-display" class="text-sm font-medium" style="color:#BE8296;"><span id="percentage">0</span>%</span>
         </div>
         <div class="h-2 rounded-full overflow-hidden" style="background:#F0E0E6;">
           <div id="progress-bar" class="progress-bar h-full rounded-full" style="width:2.5%; background: linear-gradient(90deg,#BE8296,#D4A5B5);"></div>
         </div>
       </div>
       <!-- Question -->
       <div id="question-container" class="animate-fade-in">
         <h2 id="question-text" class="font-heading text-xl sm:text-2xl font-semibold mb-6" style="color:#6B4A54;"></h2>
         <div id="options-container" class="space-y-3"></div>
       </div>
       <!-- Feedback (nÃ£o utilizado no fluxo automÃ¡tico) -->
       <div id="feedback-container" class="hidden mt-6 p-4 rounded-2xl animate-fade-in">
         <p id="feedback-text" class="font-medium mb-2"></p>
         <p id="explanation-text" class="text-sm" style="color:#8B6B75;"></p>
       </div>
       <!-- Next Button (usado apenas em etapas especiais) -->
       <button id="next-btn" onclick="nextQuestion()" class="hidden w-full mt-6 py-4 rounded-full font-semibold text-white transition-all hover:shadow-lg" style="background: linear-gradient(135deg,#BE8296 0%,#A06B7D 100%);"> PrÃ³xima Pergunta â†’ </button>
     </div>
   </div>
   <!-- Results Screen -->
   <div id="results-screen" class="w-full max-w-2xl hidden">
     <div class="rounded-3xl p-6 sm:p-8 shadow-xl text-center animate-fade-in" style="background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);">
       <div id="result-icon" class="text-6xl sm:text-7xl mb-4"></div>
       <h2 id="result-title" class="font-heading text-2xl sm:text-3xl font-bold mb-2" style="color:#6B4A54;"></h2>
       <p id="result-score" class="text-xl mb-4" style="color:#BE8296;">Seu Perfil Personalizado</p>
       <p id="result-message" class="mb-8 max-w-md mx-auto" style="color:#8B6B75;"></p>
       <div class="grid grid-cols-2 gap-4 mb-8 max-w-xs mx-auto">
         <div class="p-4 rounded-2xl" style="background:#F8E8EC;">
           <p class="text-2xl font-bold" style="color:#6B4A54;" id="correct-count">0</p>
           <p class="text-sm" style="color:#A88B95;">Acertos</p>
         </div>
         <div class="p-4 rounded-2xl" style="background:#F8E8EC;">
           <p class="text-2xl font-bold" style="color:#6B4A54;" id="wrong-count">0</p>
           <p class="text-sm" style="color:#A88B95;">Erros</p>
         </div>
       </div>
       <div class="mb-8 p-4 rounded-2xl" style="background:#F8E8EC; border-left:4px solid #BE8296;">
         <p id="diagnosis-text" class="text-sm sm:text-base" style="color:#6B4A54;"></p>
       </div>
       <button onclick="restartQuiz()" class="option-btn px-8 py-4 rounded-full font-semibold text-lg text-white shadow-lg" style="background: linear-gradient(135deg,#BE8296 0%,#A06B7D 100%);"> ðŸ”„ Jogar Novamente </button>
     </div>
   </div>
 </div>
</div>

<script>
// --- CONFIG E QUESTÃ•ES ---
const defaultConfig = {
 quiz_title: 'SaÃºde Feminina',
 start_button_text: 'âœ¨ ComeÃ§ar Quiz',
 primary_color: '#BE8296',
 secondary_color: '#FDF2F4',
 text_color: '#6B4A54',
 accent_color: '#A06B7D',
 surface_color: '#FFFFFF',
 font_family: 'Nunito',
 font_size: 16
};

const questions = [
 // ... (as suas perguntas - jÃ¡ estÃ£o completas no seu cÃ³digo acima) ...
 // (mantido igual ao seu cÃ³digo)
 { question: "VocÃª sabe exatamente onde fica e para que serve o assoalho pÃ©lvico?", options: ["Sim, conheÃ§o bem a anatomia e funÃ§Ã£o", "JÃ¡ ouvi falar mas nÃ£o sei detalhes", "NÃ£o faÃ§o ideia do que Ã©", "Acho que Ã© algo relacionado a Ãºtero apenas"] },
 // ... (demais perguntas) ...
 { question: "Qual resultado vocÃª mais deseja alcanÃ§ar com o fortalecimento do assoalho pÃ©lvico?", options: ["Parar de perder urina e viver sem medo", "Melhorar minha vida sexual e autoestima", "Ter barriga mais definida e melhor postura", "Prevenir problemas futuros e envelhecer com saÃºde"] }
];

const stageInfo = {
1:{start:0,end:10,
curiosity:"VocÃª sabia que o assoalho pÃ©lvico Ã© composto por camadas de mÃºsculos, ligamentos e tecidos conjuntivos que formam uma espÃ©cie de 'rede' sustentando Ãºtero, bexiga e intestino? Quando essa musculatura enfraquece, Ã³rgÃ£os podem descer de posiÃ§Ã£o - Ã© o que chamamos de prolapso."},
2:{start:10,end:20,
curiosity:"Pesquisas mostram que 1 em cada 3 mulheres terÃ¡ algum grau de incontinÃªncia urinÃ¡ria ao longo da vida. O mais surpreendente? Muitas acham que Ã© 'normal' apÃ³s parto ou com a idade, mas 80% dos casos podem ser revertidos com exercÃ­cios especÃ­ficos."},
3:{start:20,end:30,
curiosity:"Estudo da Universidade de Michigan revelou que mulheres que praticam Pilates especÃ­fico para assoalho pÃ©lvico por 12 semanas tÃªm 67% mais forÃ§a muscular comparadas a quem faz apenas exercÃ­cios convencionais. O segredo estÃ¡ na ativaÃ§Ã£o correta dos mÃºsculos profundos."},
4:{start:30,end:40,
curiosity:"O assoalho pÃ©lvico Ã© o Ãºnico grupo muscular do corpo que trabalha 24 horas por dia - mesmo quando vocÃª dorme, ele sustenta seus Ã³rgÃ£os. Por isso, exercÃ­cios de fortalecimento nÃ£o sÃ£o apenas 'treino', mas sim manutenÃ§Ã£o essencial para qualidade de vida."}
};

// --- VARIÃVEIS DE ESTADO ---
let currentQuestion = 0;
let userAnswers = [];

// --- FLUXO PRINCIPAL ---
function startQuiz() {
 document.getElementById('start-screen').classList.add('hidden');
 document.getElementById('quiz-screen').classList.remove('hidden');
 currentQuestion = 0;
 userAnswers = [];
 showQuestion();
}

function showQuestion() {
 const q = questions[currentQuestion];
 const percentage = Math.round(((currentQuestion + 1) / questions.length) * 100);
 document.getElementById('current-q').textContent = currentQuestion + 1;
 document.getElementById('percentage').textContent = percentage;
 document.getElementById('progress-bar').style.width = `${percentage}%`;

 document.getElementById('question-text').textContent = q.question;

 const optionsContainer = document.getElementById('options-container');
 optionsContainer.innerHTML = '';

 q.options.forEach((option, index) => {
   const btn = document.createElement('button');
   btn.className = `option-btn w-full p-4 rounded-2xl text-left font-medium border-2 transition-all delay-${(index + 1) * 100}`;
   btn.style.cssText = 'background:#FDF2F4; border-color:#E8D0D8; color:#6B4A54;';
   btn.setAttribute('aria-label', option);
   btn.setAttribute('tabindex', '0');
   btn.innerHTML = `<span class='inline-block w-8 h-8 rounded-full text-center leading-8 mr-3' style='background:#E8D0D8;color:#6B4A54;'>${String.fromCharCode(65 + index)}</span>${option}`;
   btn.onclick = () => selectAnswer(index);
   optionsContainer.appendChild(btn);
 });

 document.getElementById('next-btn').classList.add('hidden');

 // AnimaÃ§Ã£o e acessibilidade
 const container = document.getElementById('question-container');
 container.style.opacity = '0';
 container.style.transform = 'translateY(20px)';
 setTimeout(() => {
   container.style.transition = 'all 0.5s ease-out';
   container.style.opacity = '1';
   container.style.transform = 'translateY(0)';
   // Foco no primeiro botÃ£o
   const firstBtn = optionsContainer.querySelector('button');
   if (firstBtn) firstBtn.focus();
 }, 50);
}

function selectAnswer(index) {
 // Desabilita opÃ§Ãµes
 const options = document.getElementById('options-container').children;
 for (let i = 0; i < options.length; i++) {
   options[i].disabled = true;
   if (i === index) {
     options[i].style.cssText = 'background:#BE8296;border-color:#BE8296;color:#FDF2F4;';
   }
 }

 userAnswers.push({ question: currentQuestion, answer: index });

 // Checa se Ã© fim de etapa (10/20/30) ou fim do quiz
 if ((currentQuestion + 1) % 10 === 0 && currentQuestion !== questions.length -1) {
   setTimeout(() => showStageBreak(), 400);
   return;
 }

 if (currentQuestion === questions.length -1) {
   setTimeout(() => showResults(), 400);
   return;
 }

 // AvanÃ§a automaticamente para prÃ³xima pergunta apÃ³s pequeno delay
 setTimeout(() => {
   currentQuestion++;
   showQuestion();
 }, 400);
}

function nextQuestion() {
 currentQuestion++;
 showQuestion();
}

function showStageBreak() {
 document.getElementById('quiz-screen').classList.add('hidden');
 let stageBreak = document.getElementById('stage-break');
 if (!stageBreak) {
   stageBreak = document.createElement('div');
   stageBreak.id = 'stage-break';
   stageBreak.className = 'w-full max-w-2xl text-center animate-fade-in';
   document.querySelector('.relative.z-10.min-h-full').appendChild(stageBreak);
 }
 // Corrigido para pegar o stage correto (de 1 a 4)
 const stage = Math.floor((currentQuestion +1)/10);
 const curiosity = stageInfo[stage]?.curiosity || '';
 stageBreak.innerHTML = `
   <div class='rounded-3xl p-6 sm:p-8 shadow-xl animate-fade-in' style='background: rgba(255,255,255,0.85); backdrop-filter: blur(10px);'>
     <div class='text-5xl mb-4'>ðŸŒŸ</div>
     <h2 class='font-heading text-2xl sm:text-3xl font-bold mb-4' style='color:#6B4A54;'>Etapa ${stage} Completa!</h2>
     <div class='mb-6 p-4 rounded-2xl' style='background:#F8E8EC;border-left:4px solid #BE8296;'>
       <p class='text-sm sm:text-base' style='color:#6B4A54;'>${curiosity}</p>
     </div>
     <button onclick='continueQuiz()' class='option-btn px-8 py-4 rounded-full font-semibold text-lg text-white shadow-lg hover:shadow-xl' style='background: linear-gradient(135deg,#BE8296 0%,#A06B7D 100%);'>
       PrÃ³xima Etapa â†’
     </button>
   </div>`;
 stageBreak.classList.remove('hidden');
}

function continueQuiz() {
 const stageBreak = document.getElementById('stage-break');
 if (stageBreak) stageBreak.remove();
 document.getElementById('quiz-screen').classList.remove('hidden');
 currentQuestion++;
 showQuestion();
}

function showResults() {
 document.getElementById('quiz-screen').classList.add('hidden');
 document.getElementById('results-screen').classList.remove('hidden');

 // --- LÃ³gica personalizada simplificada ---
 const stage1Answers = userAnswers.filter(a => a.question <10).map(a=>a.answer);
 const stage2Answers = userAnswers.filter(a => a.question >=10 && a.question<20).map(a=>a.answer);
 const stage3Answers = userAnswers.filter(a => a.question >=20 && a.question<30).map(a=>a.answer);
 const stage4Answers = userAnswers.filter(a => a.question >=30).map(a=>a.answer);

 const severity1 = stage1Answers.reduce((sum,a)=>sum+a,0);
 const severity2 = stage2Answers.reduce((sum,a)=>sum+a,0);
 const severity3 = stage3Answers.reduce((sum,a)=>sum+a,0);
 const severity4 = stage4Answers.reduce((sum,a)=>sum+a,0);

 const totalSeverity = severity1+severity2+severity3+severity4;
 const maxSeverity =30*4;
 const severityPercentage =(totalSeverity/maxSeverity)*100;

 const hasPregnancyHistory=stage3Answers.some((a,i)=>(i===0||i===1||i===2)&&a>0);
 const hasMenopauseSymptoms=stage3Answers.some((a,i)=>(i===3||i===4)&&a>0);
 const hasSevereSymptoms=stage2Answers.some(a=>a>=2);
 const isReadyForChange=stage4Answers.slice(0,3).some(a=>a===0);

 document.getElementById('correct-count').textContent='âœ“';
 document.getElementById('wrong-count').textContent=userAnswers.length+'/40';

 let icon,title,message,diagnosis;

 if(hasMenopauseSymptoms&&severityPercentage>=40){
   icon='ðŸŒ±';
   title='PERIMENOPAUSA & TRANSFORMAÃ‡ÃƒO';
   message='VocÃª estÃ¡ vivenciando mudanÃ§as significativas em seu corpo!';
   diagnosis='VocÃª estÃ¡ na FASE DE TRANSFORMAÃ‡ÃƒO HORMONAL...';
 }else if(hasPregnancyHistory&&severity2>=15){
   icon='ðŸ’ª';
   title='GUERREIRA EM RECUPERAÃ‡ÃƒO';
   message='Seu corpo passou por transformaÃ§Ãµes e merece cuidado especial!';
   diagnosis='Seu corpo passou pela transformaÃ§Ã£o mais poderosa que existe...';
 }else if(severity2>=20&&isReadyForChange){
   icon='ðŸ’';
   title='CRÃ”NICA DECIDIDA';
   message='VocÃª estÃ¡ pronta para encontrar sua soluÃ§Ã£o definitiva!';
   diagnosis='VocÃª Ã© uma PERSEVERANTE DA SAÃšDE PÃ‰LVICA...';
 }else{
   icon='ðŸŒŸ';
   title='CONSCIENTE PREPARADA';
   message='VocÃª estÃ¡ buscando conhecimento para cuidar bem de si mesma!';
   diagnosis='Seu mapa revela que vocÃª estÃ¡ na FASE DE ALERTA SILENCIOSO...';
 }

 document.getElementById('result-icon').textContent=icon;
 document.getElementById('result-title').textContent=title;
 document.getElementById('result-message').textContent=message;
 const diagnosisElement=document.getElementById('diagnosis-text');
 if(diagnosisElement){diagnosisElement.textContent=diagnosis;}
}

function restartQuiz() {
 document.getElementById('results-screen').classList.add('hidden');
 document.getElementById('start-screen').classList.remove('hidden');
}

// --- CONFIGURAÃ‡ÃƒO DINÃ‚MICA ---
async function onConfigChange(config) {
 const title=config.quiz_title||defaultConfig.quiz_title;
 const startBtnText=config.start_button_text||defaultConfig.start_button_text;
 const fontFamily=config.font_family||defaultConfig.font_family;
 const fontSize=config.font_size||defaultConfig.font_size;

 document.getElementById('quiz-title').textContent=title;
 document.getElementById('start-btn').textContent=startBtnText;

 document.body.style.fontFamily=`${fontFamily}, sans-serif`;
 document.getElementById('quiz-title').style.fontSize=`${fontSize*2.5}px`;
}

if(window.elementSdk){
 window.elementSdk.init({
   defaultConfig,
   onConfigChange,
   mapToCapabilities:(config)=>({
     recolorables:[
       {get:()=>config.secondary_color||defaultConfig.secondary_color,set:(value)=>window.elementSdk.setConfig({secondary_color:value})},
       {get:()=>config.surface_color||defaultConfig.surface_color,set:(value)=>window.elementSdk.setConfig({surface_color:value})},
       {get:()=>config.text_color||defaultConfig.text_color,set:(value)=>window.elementSdk.setConfig({text_color:value})},
       {get:()=>config.primary_color||defaultConfig.primary_color,set:(value)=>window.elementSdk.setConfig({primary_color:value})},
       {get:()=>config.accent_color||defaultConfig.accent_color,set:(value)=>window.elementSdk.setConfig({accent_color:value})}
     ],
     borderables:[]
     ,fontEditable:{get:()=>config.font_family||defaultConfig.font_family,set:(value)=>window.elementSdk.setConfig({font_family:value})},
     fontSizeable:{get:()=>config.font_size||defaultConfig.font_size,set:(value)=>window.elementSdk.setConfig({font_size:value})}
   }),
   mapToEditPanelValues:(config)=>new Map([
     ['quiz_title',config.quiz_title||defaultConfig.quiz_title],
     ['start_button_text',config.start_button_text||defaultConfig.start_button_text]
   ])
 });
}
</script>

</body>
</html>
